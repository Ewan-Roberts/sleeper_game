var WindowEvent;!function(e){e[e.Load="load"]="Load",e[e.BeforeUnload="beforeunload"]="BeforeUnload",e[e.Abort="abort"]="Abort",e[e.Error="error"]="Error"}(WindowEvent||(WindowEvent={}));var AjaxTiming=function(){function e(e,t,n,r){var o=this;this.getPerformanceTimings=function(e){o.connect=e.connectEnd-e.connectStart,o.dns=e.domainLookupEnd-e.domainLookupStart,o.duration=e.duration,o.load=e.responseEnd-e.responseStart,o.wait=e.responseStart-e.requestStart,o.start=e.startTime,o.redirect=e.redirectEnd-e.redirectStart,e.secureConnectionStart&&(o.ssl=e.connectEnd-e.secureConnectionStart)},this.url=e,this.method=t,this.isAsync=n,this.open=r}return e}(),ProfilerJsError=function(){function e(e,t,n){this.count=0,this.message=e,this.url=t,this.lineNumber=n}return e.createText=function(e,t,n){return[e,t,n].join(":")},e.prototype.getText=function(){return e.createText(this.message,this.url,this.lineNumber)},e}(),ProfilerEventManager=function(){function e(){this.events=[],this.hasAttachEvent=!!window.attachEvent}return e.prototype.add=function(e,t,n){this.events.push({type:e,target:t,func:n}),this.hasAttachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n,!1)},e.prototype.clear=function(){for(var e,t=0,n=this.events;t<n.length;t++)e=n[t],this.hasAttachEvent?e.target.detachEvent(e.type,e.func):e.target.removeEventListener(e.type,e.func,!1);this.events=[]},e}(),RProfiler=function(){function e(){function e(e){var n=e.target||e.srcElement;return 3==n.nodeType&&(n=n.parentNode),t("N/A",n.src||n.URL,-1),!1}var t,n,r,o,i,s=this;this.restUrl="g.3gl.net/jp/111/v3/M",this.startTime=(new Date).getTime(),this.info={},this.hasInsight=!1,this.data={start:this.startTime,jsCount:0,jsErrors:[],loadTime:-1,loadFired:!1,ajax:[]},this.eventManager=new ProfilerEventManager,this.startAjaxCapture=function(){var e,t=XMLHttpRequest.prototype,n=t.open,r=t.send,o=[],i={},a=s.data.ajax,c=25,d="object"==typeof performance&&"function"==typeof window.performance.now&&"function"==typeof window.performance.getEntriesByType;d&&window.performance.setResourceTimingBufferSize(300),e=function(){return d?window.performance.now():(new Date).getTime()},t.open=function(t,r,i,s,a){void 0===i&&(i=!0),this.rpIndex=o.length,o.push(new AjaxTiming(r,t,i,e())),n.call(this,t,r,i,s,a)},t.send=function(t){var n,s=this,u=this.onreadystatechange;this.onreadystatechange=function(){var t,n=o[s.rpIndex];if(n){switch(s.readyState){case 1:n.connectionEstablished=e();break;case 2:n.requestReceived=e();break;case 3:n.processingTime=e();break;case 4:switch(n.complete=e(),t=!(!s.response||null==s.response||s.response==undefined),s.responseType){case"text":case"":"string"==typeof s.responseText&&(n.responseSize=s.responseText.length);break;case"json":t&&"function"==typeof s.response.toString&&(n.responseSize=s.response.toString().length);break;case"arraybuffer":t&&"number"==typeof s.response.byteLength&&(n.responseSize=s.response.byteLength);break;case"blob":t&&"number"==typeof s.response.size&&(n.responseSize=s.response.size)}!function(e){setTimeout(function(){var t,n,r,o,s;if(d){var c=e.url,u=[],f=performance.getEntriesByType("resource");for(t=0,n=f;t<n.length;t++)r=n[t],r.name==c&&u.push(r);if(a.push(e),0!=u.length){if(i[c]||(i[c]=[]),1==u.length)return e.getPerformanceTimings(u[0]),void i[c].push(0);o=i[c];for(s in u)if(-1==o.indexOf(s))return e.getPerformanceTimings(u[s]),void o.push(s);e.getPerformanceTimings(u[0])}}},c)}(n)}"function"==typeof u&&u.call(s)}},(n=o[this.rpIndex])&&(t&&!isNaN(t.length)&&(n.sendSize=t.length),n.send=e(),r.call(this,t))}},this.recordPageLoad=function(){s.data.loadTime=(new Date).getTime(),s.data.loadFired=!0},this.addError=function(e,t,n){var r,o,i,a,c;for(s.data.jsCount++,r=ProfilerJsError.createText(e,t,n),o=s.data.jsErrors,i=0,a=o;i<a.length;i++)if(c=a[i],c.getText()==r)return void c.count++;o.push(new ProfilerJsError(e,t,n))},this.addInfo=function(e,t,n){if(!s.isNullOrEmpty(e)){if(s.isNullOrEmpty(n))s.info[e]=t;else{if(s.isNullOrEmpty(t))return;s.isNullOrEmpty(s.info[e])&&(s.info[e]={}),s.info[e][t]=n}s.hasInsight=!0}},this.clearInfo=function(){s.info={},s.hasInsight=!1},this.getInfo=function(){return s.hasInsight?s.info:null},this.eventManager.add(WindowEvent.Load,window,this.recordPageLoad),t=this.addError,this.startAjaxCapture(),window.opera?this.eventManager.add(WindowEvent.Error,document,e):"onerror"in window&&(n=window.onerror,window.onerror=function(e,r,o){return t(e,r,o),!!n&&n(e,r,o)}),!window.__cpCdnPath||(this.restUrl=window.__cpCdnPath.trim()),r=document.createElement("iframe"),o=r.style,o.position="absolute",o.top="-10000px",o.left="-1000px",i=document.getElementsByTagName("script")[0],i.parentNode.insertBefore(r,i);var a=r.contentWindow.document.open("text/html","replace"),c=window.location.protocol+"//",d='<body onload="';d+="function s(u){var d=document,s=d.createElement('script');s.type='text/javascript';s.src=u;d.body.appendChild(s);}",d+="s('"+c+this.restUrl+"');",d+='"></body>',a.write(d),a.close()}return e.prototype.isNullOrEmpty=function(e){if(e===undefined||null===e)return!0;if("string"==typeof e){return 0==e.trim().length}return!1},e.prototype.dispatchCustomEvent=function(e){!function(e){function t(e,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if("function"==typeof e.CustomEvent)return!1;t.prototype=Event.prototype,e.CustomEvent=t}(window);var t=new CustomEvent(e);window.dispatchEvent(t)},e}(),profiler=new RProfiler;window.RProfiler=profiler,window.WindowEvent=WindowEvent,profiler.dispatchCustomEvent("GlimpseLoaded");